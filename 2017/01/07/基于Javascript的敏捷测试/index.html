<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>基于Javascript的敏捷测试 - Siyu</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><div class="post-header"><img class="background" src="/default_images/post_background.jpg"><div class="post-title"><h1 class="title">基于Javascript的敏捷测试</h1><ul class="meta"><li><i class="icon icon-author"></i>Siyu Yan</li><li><i class="icon icon-clock"></i>6 Minutes</li><li><i class="icon icon-calendar"></i>January 7, 2017</li></ul></div></div><div class="article-content"><p>本文将从测试金字塔的各个层面分层介绍敏捷团队在项目交付中如何选择适合的测试框架快速、低成本搭建自动化测试框架的过程。那么接下来将借助Javascript这样一门简单、轻量级的越来越热门的动态语言来介绍。</p>
<p>随着前端技术发展越来越快，基于JavaScript的前端Web Application越来越多，同时随着开发人员对Nodejs的应用也在不断增加，团队中可以使用JavaScript完成对于一个Web Application的前后端全栈开发。与此同时也可以使用JavaScript完成绝大部分的自动化测试，从而可以统一开发团队的技术栈，复用团队的开发人员来开发和维护自动化测试，降低自动化测试的开发和维护成本，并实现JavaScript敏捷自动化测试。</p>
<p>为了适应这样的开发环境，基于JavaScript的测试框架和工具也随之高速发展，比如出现了Jasmine，Protractor，Mocha，Selenium，FrisbyJs，Supertest等一批优秀和高效的测试框架和工具来帮团队完成金字塔各层不同类型要求的自动化测试。</p>
<h3 id="问题金字塔"><a href="#问题金字塔" class="headerlink" title="问题金字塔"></a>问题金字塔</h3><p>在实际的项目交付开发中，对于开发和测试人员来说会有很多痛点想要解决，比如：</p>
<p><img src="/images/基于Javascript的敏捷测试/问题金字塔.png" alt="问题金字塔"></p>
<h3 id="测试金字塔"><a href="#测试金字塔" class="headerlink" title="测试金字塔"></a>测试金字塔</h3><p>那么如何在自动化测试中低成本的解决这些问题呢？是否有哪些好的框架和工具可以选择？接下来就从测试金字塔分层由下至上来介绍。</p>
<p><img src="/images/基于Javascript的敏捷测试/测试金字塔.png" alt="测试金字塔"></p>
<h3 id="Javascript单元测试-与-TDD"><a href="#Javascript单元测试-与-TDD" class="headerlink" title="Javascript单元测试 与 TDD"></a>Javascript单元测试 与 TDD</h3><h4 id="TDD的概念和流程"><a href="#TDD的概念和流程" class="headerlink" title="TDD的概念和流程"></a>TDD的概念和流程</h4><p>TDD：测试驱动开发(Test Driven Development)</p>
<p>对TDD有所了解的人都知道，其实TDD无非是测试优于开发代码先行的思路。但这里，我们更强调的是在使用TDD的思想来帮助我们开发的时候重构的思想，也就是TDD = TFD（Test First Development） + Refactoring</p>
<p><img src="/images/基于Javascript的敏捷测试/TDD.png" alt="TDD"></p>
<p>整个使用TDD开发的流程（对应上图）概括起来是：</p>
<ul>
<li>加入一个新的测试</li>
<li>运行下新加的测试，看到它失败</li>
<li>对开发代码做很小的修改，目的就是让新加的测试通过</li>
<li>运行所有的测试（test case），然后看到所有测试都通过</li>
<li>移掉重复的代码，对代码进行重构 </li>
</ul>
<h4 id="单元测试的实践方式与优势"><a href="#单元测试的实践方式与优势" class="headerlink" title="单元测试的实践方式与优势"></a>单元测试的实践方式与优势</h4><p>当然进行的过程不会那么顺利，尤其是在一些业务场景复杂的时候，很难保证划分的单元（Unit）是足够小。虽然TDD很美好，但是很多团队做起TDD来对整体的开发效率、开发质量并没有显著提高，这时就需要借鉴一些好的实践来帮助团队更好地完成TDD提高开发效率。比如以下几点：</p>
<ul>
<li>测试代码时，只考虑测试，不考虑内部实现</li>
<li>数据尽量模拟现实，越靠近现实越好</li>
<li>充分考虑数据的边界条件</li>
<li>对重点、复杂、核心代码重点测试</li>
<li>利用AOP(beforeEach、afterEach),减少测试代码数量，避免无用功能</li>
<li>测试、功能开发相结合，有利于设计和代码重构</li>
</ul>
<p>有了以上较好的TDD实践,才能更好的体现其在敏捷团队整个交付过程中的优势。如：</p>
<ul>
<li>测试代码类似文档，更易于理解，特别是复杂场景</li>
<li>在写测试的过程中理解业务逻辑</li>
<li>小步迭代，集中注意解决一个问题</li>
<li>用于验证自己所做的修改，保证没有影响原有的功能</li>
<li>更有信心的在不断的Refactor中提升代码的质量</li>
</ul>
<h4 id="单元测试框架"><a href="#单元测试框架" class="headerlink" title="单元测试框架"></a>单元测试框架</h4><p>介绍了很多理论，那么接下来就给大家介绍一些互联网上开源、简单的使用的单元测试框架，比较常用的有以下几种：</p>
<p><img src="/images/基于Javascript的敏捷测试/单元测试框架.png" alt="单元测试框架"></p>
<p>以上几种框架各有优缺点，在实际项目对框架选择时可以结合项目实际情况和人员技术栈来进行选择。对于Javascript测试可以参考如下代码结构，这个不同语言和框架差别不大，在此不再赘述。</p>
<p><img src="/images/基于Javascript的敏捷测试/单元测试代码结构.png" alt="单元测试代码结构"></p>
<h3 id="Javascript-API测试"><a href="#Javascript-API测试" class="headerlink" title="Javascript API测试"></a>Javascript API测试</h3><h4 id="API测试类型和特点"><a href="#API测试类型和特点" class="headerlink" title="API测试类型和特点"></a>API测试类型和特点</h4><p>单元测试侧重于函数的内部逻辑实现，而API侧重于暴露出来的功能是否能够很好的满足使用者的需要。从API提供方类型来分，可以分为Public API提供者或者第三方专门提供API服务的团队和本团队后端。不管是哪种，保证提供的API提供的服务是可用的都是必不可少需要测试的内容。</p>
<p><img src="/images/基于Javascript的敏捷测试/API测试.png" alt="API测试"></p>
<p>API测试特点</p>
<ul>
<li>发送HTTP GET、POST、PUT、DELETE请求</li>
<li>支持Restful/WSDL等Service请求</li>
<li>发送加密请求</li>
<li>对请求的结果进行测试</li>
<li>学习成本低，可扩展性强</li>
<li>代码易读，可以生成测试报告</li>
<li>可以通过简单代码完成基本的测试场景</li>
<li>简本执行简单，有基本的断言功能</li>
<li>支持CI/CD，可完全自动化的运行测试脚本</li>
<li>使用方便，可支持复杂模式的API调用</li>
</ul>
<h4 id="API测试方式"><a href="#API测试方式" class="headerlink" title="API测试方式"></a>API测试方式</h4><p>在具体测试时，针对API的测试方式大体可以分为两种：使用工具测试API和使用代码测试API。当然，一些好的测试工具同时也支持写一些自定义的code来帮助验证API返回值是否正确等。同样，我也列出了一些简单使用开源的API工具和框架。</p>
<p><img src="/images/基于Javascript的敏捷测试/API测试方式.png" alt="API测试方式"></p>
<h4 id="API测试工具"><a href="#API测试工具" class="headerlink" title="API测试工具"></a>API测试工具</h4><p>当你的团队需要用最小的成本快速验证服务时候选择这种方式绝对是第一选择。</p>
<p><img src="/images/基于Javascript的敏捷测试/API测试工具.png" alt="API测试工具"></p>
<ul>
<li>Postman是一个在Chrome中使用的REST客户端插件，通过Postman，你可以创建请求并且分析服务器端返回的信息。这个工具在开发新的API或者实现对于已有API的客户端访问代码时非常有用。Postman支持OAuth1和OAuth2，并且对于返回的JSON和XML数据都会进行排版。通过使用Postman，你可以查看你通过Postman之前发起过的请求，并且可以非常友好的编辑测试数据去测试API在不同请求下的返回。同时，虽然不鼓励录屏式的测试方法，但是Postman提供了一系列的拓展允许使用者将它作为跑测试的工具。 </li>
<li>SoapUI是一个开源的，跨平台的测试工具。它可以自动操作功能、回归、合规以及SOAP和REST web服务的负载测试。它配备了一个易于使用的图形界面，并支持行业领先的技术和标准，以模拟和鼓励web服务的行为。</li>
</ul>
<h4 id="API测试框架"><a href="#API测试框架" class="headerlink" title="API测试框架"></a>API测试框架</h4><p>通过写代码的方式来做API测试，能够最大程度帮团队自动回归测试，验证服务的正确性，同时帮助自定义对API的验证，让团队尽早发现服务中的问题。</p>
<p><img src="/images/基于Javascript的敏捷测试/API测试框架.png" alt="API测试框架"></p>
<ul>
<li>Mocha 这个轻量级的框架不仅能够做单元测试，也能用来做API测试，同时使用Supertest 这个框架进行HTTP request。</li>
<li>Jasmine 同样可以用来做API自动化测试，同时使用Frisby进行HTTP request。</li>
</ul>
<h3 id="Javascript-contract-testing-与-ATDD"><a href="#Javascript-contract-testing-与-ATDD" class="headerlink" title="Javascript contract testing 与 ATDD"></a>Javascript contract testing 与 ATDD</h3><h4 id="ATDD的概念和流程"><a href="#ATDD的概念和流程" class="headerlink" title="ATDD的概念和流程"></a>ATDD的概念和流程</h4><p>ATDD: 验收测试驱动开发(Acceptance Test Driven Development）</p>
<p>前文谈论的TDD更多的是从开发者的角度针对小的功能单元来测试驱动开发，那么还有另外一种角度，也就是<br>从客户的角度出发，针对客户的验收标准来测试驱动产品的开发，也就是ATDD。这两种角度共同保证最终的产品是符合客户需要的正确的产品。所有这些过程帮助开发人员和测试人员在实施之前了解客户的需求，并允许客户能够以自己的域语言交谈。</p>
<p><img src="/images/基于Javascript的敏捷测试/TDD与ATDD.png" alt="TDD与ATDD"></p>
<p>ATDD工作流程如下图所示，首先由开发团队和客户讨论出具体的验收标准，而后提取出具体可验收的验收测试，开发人员以此作为Guide line开发产品代码，完成最后的可交付产品。整个过程更多的是强调的是关注于业务价值并且有清晰的功能完成的标志。</p>
<p><img src="/images/基于Javascript的敏捷测试/ATDD工作流程.png" alt="ATDD工作流程"></p>
<h4 id="Contract-testing"><a href="#Contract-testing" class="headerlink" title="Contract testing"></a>Contract testing</h4></div><div class="article-meta"></div><div class="article-comment"><div class="ds-thread" id="ds-thread" data-thread-key="cixnd2o6t00061rnbiz7mxn9c" data-title="基于Javascript的敏捷测试" data-url="http://siyuyan.github.io/2017/01/07/基于Javascript的敏捷测试/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2016/08/27/DDOS/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="http://github.com/" title="GitHub" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/" title="Weibo" target="_blank"><i class="icon icon-weibo"></i></a></li><li><a href="http://www.segmentfault.com/u/bon" title="SegmentFault" target="_blank"><i class="icon icon-segmentfault"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2017 Siyu</p></div></div></body></html>